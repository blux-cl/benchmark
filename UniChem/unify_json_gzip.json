import os
import json
import gzip
import shutil

# Define the directory where the JSONs are located
json_dir = "generated_json/"

# Create an empty dictionary to store the merged JSON data
merged_data = {}

# Loop through all the JSON files in the directory
for filename in os.listdir(json_dir):
    if filename.endswith(".json"):
        # Open the JSON file and load the data
        with open(os.path.join(json_dir, filename), "r") as f:
            json_data = json.load(f)
        
        # Merge the JSON data into the main dictionary
        merged_data.update(json_data)

# Convert the merged data to JSON format
merged_json = json.dumps(merged_data)

# Compress the JSON using GZIP compression
compressed_json = gzip.compress(bytes(merged_json, "utf-8"))

# Save the compressed JSON to a file
with open("compounds.json.gz", "wb") as f:
    f.write(compressed_json)

# Print the size of the compressed file
print("Size of compressed JSON file:", os.path.getsize("compounds.json.gz"), "bytes")
